<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund">
<title>3&nbsp; 데이터 변형 – R for Data Science (2e)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./workflow-style.html" rel="next">
<link href="./workflow-basics.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8df9fc159a2c64db71ab329accd4d345.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script defer="" data-domain="r4ds.hadley.nz" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./whole-game.html">전체 게임</a></li><li class="breadcrumb-item"><a href="./data-transform.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">데이터 변형</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R for Data Science (2e)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/hadley/r4ds/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">환영합니다</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface-2e.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">제2판 서문</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">소개</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./whole-game.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">전체 게임</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">데이터 시각화</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">워크플로우: 기초</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-transform.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">데이터 변형</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">워크플로우: 코드 스타일</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">데이터 정리</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">워크플로우: 스크립트와 프로젝트</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">데이터 가져오기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">워크플로우: 도움 받기</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">시각화 (Visualize)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./layers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">레이어(Layers)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EDA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">탐색적 데이터 분석(Exploratory data analysis)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./communication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">소통(Communication)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">변형 (Transform)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logicals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">논리형 벡터</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">숫자</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">문자열</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regexps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">정규 표현식 (Regular expressions)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">팩터(Factors)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datetimes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">날짜와 시간</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missing-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">결측값(Missing values)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./joins.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">조인(Joins)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">가져오기 (Import)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spreadsheets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">스프레드시트</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">데이터베이스</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arrow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Arrow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rectangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">계층적 데이터</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./webscraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">웹 스크래핑</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">프로그램 (Program)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">함수 (Functions)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">반복</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./base-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">기본 R 필드 가이드</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./communicate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">소통 (Communicate)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto-formats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Quarto 형식</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#%EC%86%8C%EA%B0%9C" id="toc-소개" class="nav-link active" data-scroll-target="#%EC%86%8C%EA%B0%9C"><span class="header-section-number">3.1</span> 소개</a>
  <ul class="collapse">
<li><a href="#%EC%84%A0%EC%88%98-%EC%A7%80%EC%8B%9D" id="toc-선수-지식" class="nav-link" data-scroll-target="#%EC%84%A0%EC%88%98-%EC%A7%80%EC%8B%9D"><span class="header-section-number">3.1.1</span> 선수 지식</a></li>
  <li><a href="#nycflights13" id="toc-nycflights13" class="nav-link" data-scroll-target="#nycflights13"><span class="header-section-number">3.1.2</span> nycflights13</a></li>
  <li><a href="#dplyr-%EA%B8%B0%EC%B4%88" id="toc-dplyr-기초" class="nav-link" data-scroll-target="#dplyr-%EA%B8%B0%EC%B4%88"><span class="header-section-number">3.1.3</span> dplyr 기초</a></li>
  </ul>
</li>
  <li>
<a href="#%ED%96%89" id="toc-행" class="nav-link" data-scroll-target="#%ED%96%89"><span class="header-section-number">3.2</span> 행</a>
  <ul class="collapse">
<li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"><span class="header-section-number">3.2.1</span> <code>filter()</code></a></li>
  <li><a href="#%EC%9D%BC%EB%B0%98%EC%A0%81%EC%9D%B8-%EC%8B%A4%EC%88%98" id="toc-일반적인-실수" class="nav-link" data-scroll-target="#%EC%9D%BC%EB%B0%98%EC%A0%81%EC%9D%B8-%EC%8B%A4%EC%88%98"><span class="header-section-number">3.2.2</span> 일반적인 실수</a></li>
  <li><a href="#arrange" id="toc-arrange" class="nav-link" data-scroll-target="#arrange"><span class="header-section-number">3.2.3</span> <code>arrange()</code></a></li>
  <li><a href="#distinct" id="toc-distinct" class="nav-link" data-scroll-target="#distinct"><span class="header-section-number">3.2.4</span> <code>distinct()</code></a></li>
  <li><a href="#%EC%97%B0%EC%8A%B5%EB%AC%B8%EC%A0%9C" id="toc-연습문제" class="nav-link" data-scroll-target="#%EC%97%B0%EC%8A%B5%EB%AC%B8%EC%A0%9C"><span class="header-section-number">3.2.5</span> 연습문제</a></li>
  </ul>
</li>
  <li>
<a href="#%EC%97%B4" id="toc-열" class="nav-link" data-scroll-target="#%EC%97%B4"><span class="header-section-number">3.3</span> 열</a>
  <ul class="collapse">
<li><a href="#sec-mutate" id="toc-sec-mutate" class="nav-link" data-scroll-target="#sec-mutate"><span class="header-section-number">3.3.1</span> <code>mutate()</code></a></li>
  <li><a href="#sec-select" id="toc-sec-select" class="nav-link" data-scroll-target="#sec-select"><span class="header-section-number">3.3.2</span> <code>select()</code></a></li>
  <li><a href="#rename" id="toc-rename" class="nav-link" data-scroll-target="#rename"><span class="header-section-number">3.3.3</span> <code>rename()</code></a></li>
  <li><a href="#relocate" id="toc-relocate" class="nav-link" data-scroll-target="#relocate"><span class="header-section-number">3.3.4</span> <code>relocate()</code></a></li>
  <li><a href="#%EC%97%B0%EC%8A%B5%EB%AC%B8%EC%A0%9C-1" id="toc-연습문제-1" class="nav-link" data-scroll-target="#%EC%97%B0%EC%8A%B5%EB%AC%B8%EC%A0%9C-1"><span class="header-section-number">3.3.5</span> 연습문제</a></li>
  </ul>
</li>
  <li><a href="#sec-the-pipe" id="toc-sec-the-pipe" class="nav-link" data-scroll-target="#sec-the-pipe"><span class="header-section-number">3.4</span> 파이프</a></li>
  <li>
<a href="#%EA%B7%B8%EB%A3%B9" id="toc-그룹" class="nav-link" data-scroll-target="#%EA%B7%B8%EB%A3%B9"><span class="header-section-number">3.5</span> 그룹</a>
  <ul class="collapse">
<li><a href="#group_by" id="toc-group_by" class="nav-link" data-scroll-target="#group_by"><span class="header-section-number">3.5.1</span> <code>group_by()</code></a></li>
  <li><a href="#sec-summarize" id="toc-sec-summarize" class="nav-link" data-scroll-target="#sec-summarize"><span class="header-section-number">3.5.2</span> <code>summarize()</code></a></li>
  <li><a href="#slice_-%ED%95%A8%EC%88%98%EB%93%A4" id="toc-slice_-함수들" class="nav-link" data-scroll-target="#slice_-%ED%95%A8%EC%88%98%EB%93%A4"><span class="header-section-number">3.5.3</span> <code>slice_</code> 함수들</a></li>
  <li><a href="#%EC%97%AC%EB%9F%AC-%EB%B3%80%EC%88%98%EB%A1%9C-%EA%B7%B8%EB%A3%B9%ED%99%94%ED%95%98%EA%B8%B0" id="toc-여러-변수로-그룹화하기" class="nav-link" data-scroll-target="#%EC%97%AC%EB%9F%AC-%EB%B3%80%EC%88%98%EB%A1%9C-%EA%B7%B8%EB%A3%B9%ED%99%94%ED%95%98%EA%B8%B0"><span class="header-section-number">3.5.4</span> 여러 변수로 그룹화하기</a></li>
  <li><a href="#%EA%B7%B8%EB%A3%B9%ED%99%94-%ED%95%B4%EC%A0%9C%ED%95%98%EA%B8%B0" id="toc-그룹화-해제하기" class="nav-link" data-scroll-target="#%EA%B7%B8%EB%A3%B9%ED%99%94-%ED%95%B4%EC%A0%9C%ED%95%98%EA%B8%B0"><span class="header-section-number">3.5.5</span> 그룹화 해제하기</a></li>
  <li><a href="#by" id="toc-by" class="nav-link" data-scroll-target="#by"><span class="header-section-number">3.5.6</span> <code>.by</code></a></li>
  <li><a href="#%EC%97%B0%EC%8A%B5%EB%AC%B8%EC%A0%9C-2" id="toc-연습문제-2" class="nav-link" data-scroll-target="#%EC%97%B0%EC%8A%B5%EB%AC%B8%EC%A0%9C-2"><span class="header-section-number">3.5.7</span> 연습문제</a></li>
  </ul>
</li>
  <li><a href="#sec-sample-size" id="toc-sec-sample-size" class="nav-link" data-scroll-target="#sec-sample-size"><span class="header-section-number">3.6</span> 사례 연구: 집계 및 표본 크기</a></li>
  <li><a href="#%EC%9A%94%EC%95%BD" id="toc-요약" class="nav-link" data-scroll-target="#%EC%9A%94%EC%95%BD"><span class="header-section-number">3.7</span> 요약</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/hadley/r4ds/edit/main/data-transform.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/hadley/r4ds/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./whole-game.html">전체 게임</a></li><li class="breadcrumb-item"><a href="./data-transform.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">데이터 변형</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-data-transform" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">데이터 변형</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="소개" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="소개">
<span class="header-section-number">3.1</span> 소개</h2>
<p>시각화는 통찰력을 생성하는 데 중요한 도구이지만, 원하는 그래프를 만드는 데 필요한 정확한 형태로 데이터를 얻는 경우는 드뭅니다. 종종 데이터로 질문에 답하기 위해 새로운 변수나 요약을 생성해야 하거나, 데이터를 다루기 조금 더 쉽게 만들기 위해 변수의 이름을 바꾸거나 관측값의 순서를 변경하고 싶을 수도 있습니다. 이 장에서는 <strong>dplyr</strong> 패키지와 2013년 뉴욕시에서 출발한 항공편에 대한 새로운 데이터셋을 사용하여 데이터 변형을 소개하며 그 모든 작업(그리고 그 이상!)을 수행하는 방법을 배울 것입니다.</p>
<p>이 장의 목표는 데이터 프레임을 변형하기 위한 모든 주요 도구에 대한 개요를 제공하는 것입니다. 데이터 프레임의 행과 열에서 작동하는 함수로 시작한 다음, 동사들을 결합하는 데 사용하는 중요한 도구인 파이프에 대해 더 이야기하기 위해 다시 돌아올 것입니다. 그런 다음 그룹으로 작업하는 기능을 소개할 것입니다. 이 장은 이러한 함수들이 실제로 작동하는 것을 보여주는 사례 연구로 마무리할 것입니다. 이후 장에서는 특정 유형의 데이터(예: 숫자, 문자열, 날짜)를 파고들기 시작하면서 함수들에 대해 더 자세히 다룰 것입니다.</p>
<section id="선수-지식" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="선수-지식">
<span class="header-section-number">3.1.1</span> 선수 지식</h3>
<p>이 장에서는 tidyverse의 또 다른 핵심 멤버인 dplyr 패키지에 초점을 맞출 것입니다. nycflights13 패키지의 데이터를 사용하여 핵심 아이디어를 설명하고 데이터를 이해하는 데 도움이 되도록 ggplot2를 사용할 것입니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/nycflights13">nycflights13</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.5.2</span></span>
<span><span class="co">#&gt; Warning: package 'readr' was built under R version 4.5.2</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ───────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0</span></span>
<span><span class="co">#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1</span></span>
<span><span class="co">#&gt; ✔ purrr     1.2.0     </span></span>
<span><span class="co">#&gt; ── Conflicts ─────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>tidyverse를 로드할 때 출력되는 충돌 메시지에 주의하세요. 이 메시지는 dplyr이 기본(base) R의 일부 함수를 덮어쓴다고 알려줍니다. dplyr을 로드한 후 이러한 함수의 기본 버전을 사용하려면 전체 이름인 <code><a href="https://rdrr.io/r/stats/filter.html">stats::filter()</a></code>와 <code><a href="https://rdrr.io/r/stats/lag.html">stats::lag()</a></code>를 사용해야 합니다. 지금까지는 함수가 어떤 패키지에서 왔는지 거의 무시했는데, 대개는 중요하지 않기 때문입니다. 하지만 패키지를 알면 도움말을 찾고 관련 함수를 찾는 데 도움이 될 수 있으므로, 함수가 어떤 패키지에서 왔는지 정확히 해야 할 때는 R과 동일한 구문인 <code>packagename::functionname()</code>을 사용할 것입니다.</p>
</section><section id="nycflights13" class="level3" data-number="3.1.2"><h3 data-number="3.1.2" class="anchored" data-anchor-id="nycflights13">
<span class="header-section-number">3.1.2</span> nycflights13</h3>
<p>기본적인 dplyr 동사를 탐색하기 위해 <code><a href="https://rdrr.io/pkg/nycflights13/man/flights.html">nycflights13::flights</a></code>를 사용할 것입니다. 이 데이터셋에는 2013년 뉴욕시에서 출발한 모든 336,776개의 항공편이 포함되어 있습니다. 데이터는 미국 <a href="https://www.transtats.bts.gov/DL_SelectFields.aspx?gnoyr_VQ=FGJ&amp;QO_fu146_anzr=b0-gvzr">교통통계국(Bureau of Transportation Statistics)</a>에서 가져왔으며 <code><a href="https://rdrr.io/pkg/nycflights13/man/flights.html">?flights</a></code>에 문서화되어 있습니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code>flights</code>는 티블(tibble)로, 몇 가지 일반적인 문제를 피하기 위해 tidyverse에서 사용하는 특별한 유형의 데이터 프레임입니다. 티블과 데이터 프레임의 가장 중요한 차이점은 티블이 출력되는 방식입니다. 티블은 대규모 데이터셋을 위해 설계되었으므로 처음 몇 개의 행과 한 화면에 맞는 열만 보여줍니다. 모든 것을 볼 수 있는 몇 가지 옵션이 있습니다. RStudio를 사용하는 경우 가장 편리한 방법은 아마도 <code>View(flights)</code>일 텐데, 이는 대화형으로 스크롤 및 필터링이 가능한 뷰를 엽니다. 그렇지 않으면 <code>print(flights, width = Inf)</code>를 사용하여 모든 열을 표시하거나 <code><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse()</a></code>를 사용할 수 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">flights</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 336,776</span></span>
<span><span class="co">#&gt; Columns: 19</span></span>
<span><span class="co">#&gt; $ year           &lt;int&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013…</span></span>
<span><span class="co">#&gt; $ month          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ day            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ dep_time       &lt;int&gt; 517, 533, 542, 544, 554, 554, 555, 557, 557, 558, 55…</span></span>
<span><span class="co">#&gt; $ sched_dep_time &lt;int&gt; 515, 529, 540, 545, 600, 558, 600, 600, 600, 600, 60…</span></span>
<span><span class="co">#&gt; $ dep_delay      &lt;dbl&gt; 2, 4, 2, -1, -6, -4, -5, -3, -3, -2, -2, -2, -2, -2,…</span></span>
<span><span class="co">#&gt; $ arr_time       &lt;int&gt; 830, 850, 923, 1004, 812, 740, 913, 709, 838, 753, 8…</span></span>
<span><span class="co">#&gt; $ sched_arr_time &lt;int&gt; 819, 830, 850, 1022, 837, 728, 854, 723, 846, 745, 8…</span></span>
<span><span class="co">#&gt; $ arr_delay      &lt;dbl&gt; 11, 20, 33, -18, -25, 12, 19, -14, -8, 8, -2, -3, 7,…</span></span>
<span><span class="co">#&gt; $ carrier        &lt;chr&gt; "UA", "UA", "AA", "B6", "DL", "UA", "B6", "EV", "B6"…</span></span>
<span><span class="co">#&gt; $ flight         &lt;int&gt; 1545, 1714, 1141, 725, 461, 1696, 507, 5708, 79, 301…</span></span>
<span><span class="co">#&gt; $ tailnum        &lt;chr&gt; "N14228", "N24211", "N619AA", "N804JB", "N668DN", "N…</span></span>
<span><span class="co">#&gt; $ origin         &lt;chr&gt; "EWR", "LGA", "JFK", "JFK", "LGA", "EWR", "EWR", "LG…</span></span>
<span><span class="co">#&gt; $ dest           &lt;chr&gt; "IAH", "IAH", "MIA", "BQN", "ATL", "ORD", "FLL", "IA…</span></span>
<span><span class="co">#&gt; $ air_time       &lt;dbl&gt; 227, 227, 160, 183, 116, 150, 158, 53, 140, 138, 149…</span></span>
<span><span class="co">#&gt; $ distance       &lt;dbl&gt; 1400, 1416, 1089, 1576, 762, 719, 1065, 229, 944, 73…</span></span>
<span><span class="co">#&gt; $ hour           &lt;dbl&gt; 5, 5, 5, 5, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6…</span></span>
<span><span class="co">#&gt; $ minute         &lt;dbl&gt; 15, 29, 40, 45, 0, 58, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59…</span></span>
<span><span class="co">#&gt; $ time_hour      &lt;dttm&gt; 2013-01-01 05:00:00, 2013-01-01 05:00:00, 2013-01-0…</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>두 보기 모두 변수 이름 뒤에 각 변수의 유형을 알려주는 약어가 옵니다. <code>&lt;int&gt;</code>는 정수(integer)의 줄임말이고, <code>&lt;dbl&gt;</code>은 배정밀도 실수(double, 일명 실수)의 줄임말이며, <code>&lt;chr&gt;</code>은 문자(character, 일명 문자열), <code>&lt;dttm&gt;</code>은 날짜-시간(date-time)입니다. 열에 대해 수행할 수 있는 작업은 “유형”에 크게 의존하기 때문에 이것들은 중요합니다.</p>
</section><section id="dplyr-기초" class="level3" data-number="3.1.3"><h3 data-number="3.1.3" class="anchored" data-anchor-id="dplyr-기초">
<span class="header-section-number">3.1.3</span> dplyr 기초</h3>
<p>여러분은 데이터 조작 과제의 대다수를 해결할 수 있게 해주는 주요 dplyr 동사(함수)를 배우게 될 것입니다. 하지만 개별적인 차이점을 논의하기 전에 공통점을 언급할 가치가 있습니다:</p>
<ol type="1">
<li><p>첫 번째 인수는 항상 데이터 프레임입니다.</p></li>
<li><p>후속 인수는 일반적으로 변수 이름(따옴표 없이)을 사용하여 작업할 열을 설명합니다.</p></li>
<li><p>출력은 항상 새로운 데이터 프레임입니다.</p></li>
</ol>
<p>각 동사는 한 가지 일을 잘 수행하므로 복잡한 문제를 해결하려면 일반적으로 여러 동사를 결합해야 하며, 파이프 <code>|&gt;</code>를 사용하여 그렇게 할 것입니다. <a href="#sec-the-pipe" class="quarto-xref"><span>Section 3.4</span></a> 에서 파이프에 대해 더 논의하겠지만, 간단히 말해 파이프는 왼쪽에 있는 것을 오른쪽의 함수로 전달하므로 <code>x |&gt; f(y)</code>는 <code>f(x, y)</code>와 동일하고 <code>x |&gt; f(y) |&gt; g(z)</code>는 <code>g(f(x, y), z)</code>와 동일합니다. 파이프를 발음하는 가장 쉬운 방법은 “then(그 다음)”입니다. 덕분에 아직 세부 사항을 배우지 않았더라도 다음 코드의 의미를 파악할 수 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dest</span> <span class="op">==</span> <span class="st">"IAH"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    arr_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">arr_delay</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>dplyr의 동사는 작업 대상에 따라 <strong>행(rows)</strong>, <strong>열(columns)</strong>, <strong>그룹(groups)</strong>, <strong>테이블(tables)</strong> 의 네 그룹으로 구성됩니다. 다음 섹션에서는 행, 열, 그룹에 대한 가장 중요한 동사를 배울 것입니다. 그런 다음 <a href="joins.html" class="quarto-xref"><span>Chapter 19</span></a> 에서 테이블에서 작동하는 조인(join) 동사에 대해 다시 이야기할 것입니다. 시작해 봅시다!</p>
</section></section><section id="행" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="행">
<span class="header-section-number">3.2</span> 행</h2>
<p>데이터셋의 행에서 작동하는 가장 중요한 동사는 순서를 변경하지 않고 어떤 행이 존재하는지를 변경하는 <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>와 어떤 행이 존재하는지를 변경하지 않고 행의 순서를 변경하는 <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code>입니다. 두 함수 모두 행에만 영향을 미치며 열은 변경되지 않습니다. 또한 고유한 값을 가진 행을 찾는 <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code>에 대해서도 논의할 것입니다. <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> 및 <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>와 달리 선택적으로 열을 수정할 수도 있습니다.</p>
<section id="filter" class="level3" data-number="3.2.1"><h3 data-number="3.2.1" class="anchored" data-anchor-id="filter">
<span class="header-section-number">3.2.1</span> <code>filter()</code>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>를 사용하면 열의 값에 따라 행을 유지할 수 있습니다<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. 첫 번째 인수는 데이터 프레임입니다. 두 번째 및 후속 인수는 행을 유지하기 위해 참이어야 하는 조건입니다. 예를 들어, 120분(2시간) 이상 늦게 출발한 모든 항공편을 찾을 수 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dep_delay</span> <span class="op">&gt;</span> <span class="fl">120</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 9,723 × 19</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      848           1835       853     1001           1950</span></span>
<span><span class="co">#&gt; 2  2013     1     1      957            733       144     1056            853</span></span>
<span><span class="co">#&gt; 3  2013     1     1     1114            900       134     1447           1222</span></span>
<span><span class="co">#&gt; 4  2013     1     1     1540           1338       122     2020           1825</span></span>
<span><span class="co">#&gt; 5  2013     1     1     1815           1325       290     2120           1542</span></span>
<span><span class="co">#&gt; 6  2013     1     1     1842           1422       260     1958           1535</span></span>
<span><span class="co">#&gt; # ℹ 9,717 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code>&gt;</code>(초과) 외에도 <code>&gt;=</code>(이상), <code>&lt;</code>(미만), <code>&lt;=</code>(이하), <code>==</code>(같음), <code>!=</code>(같지 않음)를 사용할 수 있습니다. 또한 <code>&amp;</code> 또는 <code>,</code>를 사용하여 “그리고(and)”(두 조건 모두 확인)를 나타내거나 <code>|</code>를 사용하여 “또는(or)”(둘 중 하나 확인)을 나타내어 조건을 결합할 수도 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1월 1일에 출발한 항공편</span></span>
<span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">month</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">day</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 842 × 19</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 836 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span>
<span></span>
<span><span class="co"># 1월 또는 2월에 출발한 항공편</span></span>
<span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">month</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">month</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 51,955 × 19</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 51,949 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code>|</code>와 <code>==</code>를 결합할 때 유용한 단축키가 있습니다: <code>%in%</code>. 변수가 오른쪽 값 중 하나와 같으면 행을 유지합니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1월 또는 2월에 출발한 항공편을 선택하는 더 짧은 방법</span></span>
<span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 51,955 × 19</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 51,949 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><a href="logicals.html" class="quarto-xref"><span>Chapter 12</span></a> 에서 이러한 비교 및 논리 연산자에 대해 더 자세히 다시 다룰 것입니다.</p>
<p><code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>를 실행하면 dplyr은 필터링 작업을 실행하여 새 데이터 프레임을 생성한 다음 출력합니다. dplyr 함수는 입력을 절대 수정하지 않으므로 기존 <code>flights</code> 데이터셋을 수정하지 않습니다. 결과를 저장하려면 할당 연산자 <code>&lt;-</code>를 사용해야 합니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">jan1</span> <span class="op">&lt;-</span> <span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">month</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">day</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="일반적인-실수" class="level3" data-number="3.2.2"><h3 data-number="3.2.2" class="anchored" data-anchor-id="일반적인-실수">
<span class="header-section-number">3.2.2</span> 일반적인 실수</h3>
<p>R을 처음 시작할 때 가장 저지르기 쉬운 실수는 동일성(equality)을 테스트할 때 <code>==</code> 대신 <code>=</code>를 사용하는 것입니다. <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>는 이런 일이 발생하면 알려줍니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span>month <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in `filter()`:</span></span>
<span><span class="co">#&gt; ! We detected a named input.</span></span>
<span><span class="co">#&gt; ℹ This usually means that you've used `=` instead of `==`.</span></span>
<span><span class="co">#&gt; ℹ Did you mean `month == 1`?</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>또 다른 실수는 영어에서처럼 “또는(or)” 문장을 작성하는 것입니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">month</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>이것은 오류를 발생시키지 않는다는 의미에서 “작동”하지만, <code>|</code>가 먼저 조건 <code>month == 1</code>을 확인한 다음 조건 <code>2</code>를 확인하는데, 이는 확인할 합리적인 조건이 아니므로 원하는 작업을 수행하지 않습니다. 여기서 무슨 일이 일어나고 있는지와 그 이유에 대해서는 <a href="logicals.html#sec-order-operations-boolean" class="quarto-xref"><span>Section 12.3.2</span></a> 에서 더 자세히 배울 것입니다.</p>
</section><section id="arrange" class="level3" data-number="3.2.3"><h3 data-number="3.2.3" class="anchored" data-anchor-id="arrange">
<span class="header-section-number">3.2.3</span> <code>arrange()</code>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code>는 열의 값을 기준으로 행의 순서를 변경합니다. 데이터 프레임과 정렬 기준으로 삼을 일련의 열 이름(또는 더 복잡한 표현식)을 취합니다. 둘 이상의 열 이름을 제공하면 추가 열 각각이 이전 열 값의 동점(ties)을 깨는 데 사용됩니다. 예를 들어, 다음 코드는 4개의 열에 걸쳐 있는 출발 시간을 기준으로 정렬합니다. 가장 빠른 연도를 먼저 얻은 다음, 같은 연도 내에서 가장 빠른 달 등을 얻습니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span>, <span class="va">dep_time</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> 내부의 열에 <code><a href="https://dplyr.tidyverse.org/reference/desc.html">desc()</a></code>를 사용하여 내림차순(큰 것부터 작은 것 순)으로 해당 열을 기준으로 데이터 프레임을 재정렬할 수 있습니다. 예를 들어, 이 코드는 가장 많이 지연된 항공편부터 가장 적게 지연된 항공편 순으로 정렬합니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">dep_delay</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     9      641            900      1301     1242           1530</span></span>
<span><span class="co">#&gt; 2  2013     6    15     1432           1935      1137     1607           2120</span></span>
<span><span class="co">#&gt; 3  2013     1    10     1121           1635      1126     1239           1810</span></span>
<span><span class="co">#&gt; 4  2013     9    20     1139           1845      1014     1457           2210</span></span>
<span><span class="co">#&gt; 5  2013     7    22      845           1600      1005     1044           1815</span></span>
<span><span class="co">#&gt; 6  2013     4    10     1100           1900       960     1342           2211</span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>행의 수는 변경되지 않았습니다. 데이터를 정렬하기만 했고 필터링하지는 않았습니다.</p>
</section><section id="distinct" class="level3" data-number="3.2.4"><h3 data-number="3.2.4" class="anchored" data-anchor-id="distinct">
<span class="header-section-number">3.2.4</span> <code>distinct()</code>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code>는 데이터셋에서 모든 고유한 행을 찾으므로 기술적으로는 주로 행에서 작동합니다. 그러나 대부분의 경우 일부 변수의 고유한 조합을 원할 것이므로 선택적으로 열 이름을 제공할 수도 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 중복 행이 있는 경우 제거</span></span>
<span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span>
<span></span>
<span><span class="co"># 모든 고유한 출발지 및 도착지 쌍 찾기</span></span>
<span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">dest</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 224 × 2</span></span>
<span><span class="co">#&gt;   origin dest </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 EWR    IAH  </span></span>
<span><span class="co">#&gt; 2 LGA    IAH  </span></span>
<span><span class="co">#&gt; 3 JFK    MIA  </span></span>
<span><span class="co">#&gt; 4 JFK    BQN  </span></span>
<span><span class="co">#&gt; 5 LGA    ATL  </span></span>
<span><span class="co">#&gt; 6 EWR    ORD  </span></span>
<span><span class="co">#&gt; # ℹ 218 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>또는 고유한 행을 필터링할 때 다른 열을 유지하려면 <code>.keep_all = TRUE</code> 옵션을 사용할 수 있습니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">dest</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 224 × 19</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 218 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>이 모든 고유한 항공편이 1월 1일인 것은 우연이 아닙니다. <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code>는 데이터셋에서 고유한 행의 첫 번째 발생을 찾고 나머지는 버리기 때문입니다.</p>
<p>대신 발생 횟수를 찾으려면 <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code>를 <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code>로 바꾸는 것이 좋습니다. <code>sort = TRUE</code> 인수를 사용하면 발생 횟수의 내림차순으로 정렬할 수 있습니다. count에 대해서는 <a href="numbers.html#sec-counts" class="quarto-xref"><span>Section 13.3</span></a> 에서 더 자세히 배울 것입니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">dest</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 224 × 3</span></span>
<span><span class="co">#&gt;   origin dest      n</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 JFK    LAX   11262</span></span>
<span><span class="co">#&gt; 2 LGA    ATL   10263</span></span>
<span><span class="co">#&gt; 3 LGA    ORD    8857</span></span>
<span><span class="co">#&gt; 4 JFK    SFO    8204</span></span>
<span><span class="co">#&gt; 5 LGA    CLT    6168</span></span>
<span><span class="co">#&gt; 6 EWR    ORD    6100</span></span>
<span><span class="co">#&gt; # ℹ 218 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="연습문제" class="level3" data-number="3.2.5"><h3 data-number="3.2.5" class="anchored" data-anchor-id="연습문제">
<span class="header-section-number">3.2.5</span> 연습문제</h3>
<ol type="1">
<li>
<p>각 조건에 대해 단일 파이프라인에서 조건을 충족하는 모든 항공편을 찾으세요:</p>
<ul>
<li>도착 지연이 2시간 이상이었다</li>
<li>휴스턴(<code>IAH</code> 또는 <code>HOU</code>)으로 비행했다</li>
<li>유나이티드(United), 아메리칸(American), 또는 델타(Delta) 항공에 의해 운항되었다</li>
<li>여름(7월, 8월, 9월)에 출발했다</li>
<li>2시간 이상 늦게 도착했지만 늦게 출발하지 않았다</li>
<li>적어도 1시간 지연되었지만 비행 중 30분 이상 만회했다</li>
</ul>
</li>
<li><p>출발 지연이 가장 긴 항공편을 찾으려면 <code>flights</code>를 정렬하세요. 아침에 가장 일찍 떠난 항공편을 찾으세요.</p></li>
<li><p>가장 빠른 항공편을 찾으려면 <code>flights</code>를 정렬하세요. (힌트: 함수 내부에 수학 계산을 포함해 보세요.)</p></li>
<li><p>2013년의 모든 날에 항공편이 있었습니까?</p></li>
<li><p>어떤 항공편이 가장 먼 거리를 이동했습니까? 어떤 것이 가장 짧은 거리를 이동했습니까?</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>와 <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code>를 모두 사용하는 경우 어떤 순서로 사용하는지가 중요합니까? 왜 그렇습니까/그렇지 않습니까? 결과와 함수가 수행해야 할 작업량에 대해 생각해보세요.</p></li>
</ol></section></section><section id="열" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="열">
<span class="header-section-number">3.3</span> 열</h2>
<p>행을 변경하지 않고 열에 영향을 미치는 4가지 중요한 동사가 있습니다. <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>는 기존 열에서 파생된 새 열을 생성하고, <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>는 존재하는 열을 변경하고, <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code>은 열의 이름을 변경하고, <code><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate()</a></code>는 열의 위치를 변경합니다.</p>
<section id="sec-mutate" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="sec-mutate">
<span class="header-section-number">3.3.1</span> <code>mutate()</code>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>의 역할은 기존 열에서 계산된 새 열을 추가하는 것입니다. 변형(transform) 장에서는 다양한 유형의 변수를 조작하는 데 사용할 수 있는 다양한 함수 세트를 배우게 될 것입니다. 지금은 지연된 항공편이 공중에서 얼마나 많은 시간을 만회했는지(<code>gain</code>)와 시간당 마일 단위의 속도(<code>speed</code>)를 계산할 수 있는 기본 대수학을 고수할 것입니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    gain <span class="op">=</span> <span class="va">dep_delay</span> <span class="op">-</span> <span class="va">arr_delay</span>,</span>
<span>    speed <span class="op">=</span> <span class="va">distance</span> <span class="op">/</span> <span class="va">air_time</span> <span class="op">*</span> <span class="fl">60</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 21</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span>
<span><span class="co">#&gt; # ℹ 13 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>기본적으로 <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>는 데이터셋의 오른쪽에 새 열을 추가하므로 여기서 무슨 일이 일어나고 있는지 보기가 어렵습니다. 대신 <code>.before</code> 인수를 사용하여 변수를 왼쪽에 추가할 수 있습니다<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    gain <span class="op">=</span> <span class="va">dep_delay</span> <span class="op">-</span> <span class="va">arr_delay</span>,</span>
<span>    speed <span class="op">=</span> <span class="va">distance</span> <span class="op">/</span> <span class="va">air_time</span> <span class="op">*</span> <span class="fl">60</span>,</span>
<span>    .before <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 21</span></span>
<span><span class="co">#&gt;    gain speed  year month   day dep_time sched_dep_time dep_delay arr_time</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1    -9  370.  2013     1     1      517            515         2      830</span></span>
<span><span class="co">#&gt; 2   -16  374.  2013     1     1      533            529         4      850</span></span>
<span><span class="co">#&gt; 3   -31  408.  2013     1     1      542            540         2      923</span></span>
<span><span class="co">#&gt; 4    17  517.  2013     1     1      544            545        -1     1004</span></span>
<span><span class="co">#&gt; 5    19  394.  2013     1     1      554            600        -6      812</span></span>
<span><span class="co">#&gt; 6   -16  288.  2013     1     1      554            558        -4      740</span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span>
<span><span class="co">#&gt; # ℹ 12 more variables: sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code>.</code>은 <code>.before</code>가 함수에 대한 인수이지 우리가 생성하는 세 번째 새 변수의 이름이 아님을 나타냅니다. <code>.after</code>를 사용하여 변수 뒤에 추가할 수도 있으며, <code>.before</code>와 <code>.after</code> 모두에서 위치 대신 변수 이름을 사용할 수 있습니다. 예를 들어, <code>day</code> 뒤에 새 변수를 추가할 수 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    gain <span class="op">=</span> <span class="va">dep_delay</span> <span class="op">-</span> <span class="va">arr_delay</span>,</span>
<span>    speed <span class="op">=</span> <span class="va">distance</span> <span class="op">/</span> <span class="va">air_time</span> <span class="op">*</span> <span class="fl">60</span>,</span>
<span>    .after <span class="op">=</span> <span class="va">day</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>또는 <code>.keep</code> 인수로 유지되는 변수를 제어할 수 있습니다. 특히 유용한 인수는 <code>"used"</code>로, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> 단계에 포함되거나 생성된 열만 유지하도록 지정합니다. 예를 들어, 다음 출력에는 <code>dep_delay</code>, <code>arr_delay</code>, <code>air_time</code>, <code>gain</code>, <code>hours</code>, <code>gain_per_hour</code> 변수만 포함됩니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    gain <span class="op">=</span> <span class="va">dep_delay</span> <span class="op">-</span> <span class="va">arr_delay</span>,</span>
<span>    hours <span class="op">=</span> <span class="va">air_time</span> <span class="op">/</span> <span class="fl">60</span>,</span>
<span>    gain_per_hour <span class="op">=</span> <span class="va">gain</span> <span class="op">/</span> <span class="va">hours</span>,</span>
<span>    .keep <span class="op">=</span> <span class="st">"used"</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>위 계산의 결과를 <code>flights</code>에 다시 할당하지 않았기 때문에 새 변수 <code>gain</code>, <code>hours</code>, <code>gain_per_hour</code>는 출력만 되고 데이터 프레임에 저장되지 않는다는 점에 유의하세요. 나중에 사용할 수 있도록 데이터 프레임에서 사용할 수 있게 하려면 결과를 <code>flights</code>에 다시 할당하여 원본 데이터 프레임을 훨씬 더 많은 변수로 덮어쓸지, 아니면 새 객체에 할당할지 신중하게 생각해야 합니다. 종종 정답은 내용을 나타내도록 정보가 풍부하게 이름 지어진 새 객체(예: <code>delay_gain</code>)이지만, <code>flights</code>를 덮어쓰는 데에는 타당한 이유가 있을 수도 있습니다.</p>
</section><section id="sec-select" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="sec-select">
<span class="header-section-number">3.3.2</span> <code>select()</code>
</h3>
<p>수백 개 또는 수천 개의 변수가 있는 데이터셋을 얻는 것은 드문 일이 아닙니다. 이 상황에서 첫 번째 과제는 종종 관심 있는 변수에만 집중하는 것입니다. <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>를 사용하면 변수 이름을 기반으로 한 작업을 사용하여 유용한 부분집합을 빠르게 확대할 수 있습니다:</p>
<ul>
<li>
<p>이름으로 열 선택:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
<li>
<p>year와 day 사이의 모든 열 선택(포함):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">year</span><span class="op">:</span><span class="va">day</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
<li>
<p>year에서 day까지의 열을 제외한 모든 열 선택(포함):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">year</span><span class="op">:</span><span class="va">day</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>역사적으로 이 작업은 <code>!</code> 대신 <code>-</code>로 수행되었으므로 야생에서 볼 가능성이 높습니다. 이 두 연산자는 같은 목적을 수행하지만 동작에 미묘한 차이가 있습니다. <code>!</code>는 “not”으로 읽히고 <code>&amp;</code> 및 <code>|</code>와 잘 결합되므로 사용하는 것이 좋습니다.</p>
</li>
<li>
<p>문자인 모든 열 선택:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
</ul>
<p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> 내에서 사용할 수 있는 몇 가지 도우미 함수가 있습니다:</p>
<ul>
<li>
<code>starts_with("abc")</code>: “abc”로 시작하는 이름과 일치합니다.</li>
<li>
<code>ends_with("xyz")</code>: “xyz”로 끝나는 이름과 일치합니다.</li>
<li>
<code>contains("ijk")</code>: “ijk”를 포함하는 이름과 일치합니다.</li>
<li>
<code>num_range("x", 1:3)</code>: <code>x1</code>, <code>x2</code>, <code>x3</code>와 일치합니다.</li>
</ul>
<p>자세한 내용은 <code><a href="https://dplyr.tidyverse.org/reference/select.html">?select</a></code>를 참조하세요. 정규 표현식(<a href="regexps.html" class="quarto-xref"><span>Chapter 15</span></a> 의 주제)을 알고 나면 <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches()</a></code>를 사용하여 패턴과 일치하는 변수를 선택할 수도 있습니다.</p>
<p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>할 때 <code>=</code>를 사용하여 변수의 이름을 바꿀 수 있습니다. 새 이름은 <code>=</code>의 왼쪽에 나타나고 이전 변수는 오른쪽에 나타납니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>tail_num <span class="op">=</span> <span class="va">tailnum</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 1</span></span>
<span><span class="co">#&gt;   tail_num</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   </span></span>
<span><span class="co">#&gt; 1 N14228  </span></span>
<span><span class="co">#&gt; 2 N24211  </span></span>
<span><span class="co">#&gt; 3 N619AA  </span></span>
<span><span class="co">#&gt; 4 N804JB  </span></span>
<span><span class="co">#&gt; 5 N668DN  </span></span>
<span><span class="co">#&gt; 6 N39463  </span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="rename" class="level3" data-number="3.3.3"><h3 data-number="3.3.3" class="anchored" data-anchor-id="rename">
<span class="header-section-number">3.3.3</span> <code>rename()</code>
</h3>
<p>기존 변수를 모두 유지하고 몇 가지 이름만 바꾸고 싶다면 <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> 대신 <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code>을 사용할 수 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>tail_num <span class="op">=</span> <span class="va">tailnum</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>일관성 없이 명명된 열이 많아 모두 수동으로 수정하기 고통스럽다면 유용한 자동 정리를 제공하는 <code><a href="https://sfirke.github.io/janitor/reference/clean_names.html">janitor::clean_names()</a></code>를 확인해 보세요.</p>
</section><section id="relocate" class="level3" data-number="3.3.4"><h3 data-number="3.3.4" class="anchored" data-anchor-id="relocate">
<span class="header-section-number">3.3.4</span> <code>relocate()</code>
</h3>
<p>변수를 이동하려면 <code><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate()</a></code>를 사용하세요. 관련 변수를 함께 모으거나 중요한 변수를 앞으로 이동하고 싶을 수 있습니다. 기본적으로 <code><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate()</a></code>는 변수를 앞으로 이동합니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">time_hour</span>, <span class="va">air_time</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span><span class="co">#&gt;   time_hour           air_time  year month   day dep_time sched_dep_time</span></span>
<span><span class="co">#&gt;   &lt;dttm&gt;                 &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 2013-01-01 05:00:00      227  2013     1     1      517            515</span></span>
<span><span class="co">#&gt; 2 2013-01-01 05:00:00      227  2013     1     1      533            529</span></span>
<span><span class="co">#&gt; 3 2013-01-01 05:00:00      160  2013     1     1      542            540</span></span>
<span><span class="co">#&gt; 4 2013-01-01 05:00:00      183  2013     1     1      544            545</span></span>
<span><span class="co">#&gt; 5 2013-01-01 06:00:00      116  2013     1     1      554            600</span></span>
<span><span class="co">#&gt; 6 2013-01-01 05:00:00      150  2013     1     1      554            558</span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span>
<span><span class="co">#&gt; # ℹ 12 more variables: dep_delay &lt;dbl&gt;, arr_time &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>에서처럼 <code>.before</code> 및 <code>.after</code> 인수를 사용하여 어디에 둘지 지정할 수도 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">year</span><span class="op">:</span><span class="va">dep_time</span>, .after <span class="op">=</span> <span class="va">time_hour</span><span class="op">)</span></span>
<span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"arr"</span><span class="op">)</span>, .before <span class="op">=</span> <span class="va">dep_time</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="연습문제-1" class="level3" data-number="3.3.5"><h3 data-number="3.3.5" class="anchored" data-anchor-id="연습문제-1">
<span class="header-section-number">3.3.5</span> 연습문제</h3>
<ol type="1">
<li><p><code>dep_time</code>, <code>sched_dep_time</code>, <code>dep_delay</code>를 비교하세요. 이 세 숫자가 어떻게 관련될 것이라고 예상합니까?</p></li>
<li><p><code>flights</code>에서 <code>dep_time</code>, <code>dep_delay</code>, <code>arr_time</code>, <code>arr_delay</code>를 선택할 수 있는 가능한 많은 방법을 브레인스토밍하세요.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> 호출에서 동일한 변수의 이름을 여러 번 지정하면 어떻게 됩니까?</p></li>
<li>
<p><code><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of()</a></code> 함수는 무엇을 합니까? 이 벡터와 함께 사용할 때 왜 도움이 될 수 있습니까?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"dep_delay"</span>, <span class="st">"arr_delay"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
<li>
<p>다음 코드를 실행한 결과가 놀랍습니까? select 도우미는 기본적으로 대소문자를 어떻게 처리합니까? 그 기본값을 어떻게 변경할 수 있습니까?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"TIME"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
<li><p>측정 단위를 나타내기 위해 <code>air_time</code>을 <code>air_time_min</code>으로 이름을 바꾸고 데이터 프레임의 맨 앞으로 이동하세요.</p></li>
<li>
<p>다음이 작동하지 않는 이유는 무엇이며 오류는 무엇을 의미합니까?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">tailnum</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">arr_delay</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in `arrange()`:</span></span>
<span><span class="co">#&gt; ℹ In argument: `..1 = arr_delay`.</span></span>
<span><span class="co">#&gt; Caused by error:</span></span>
<span><span class="co">#&gt; ! object 'arr_delay' not found</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
</ol></section></section><section id="sec-the-pipe" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="sec-the-pipe">
<span class="header-section-number">3.4</span> 파이프</h2>
<p>위에서 파이프의 간단한 예를 보여주었지만, 진정한 힘은 여러 동사를 결합하기 시작할 때 나타납니다. 예를 들어, 휴스턴의 IAH 공항으로 가는 가장 빠른 항공편을 찾고 싶다고 상상해 보세요. <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code>를 결합해야 합니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dest</span> <span class="op">==</span> <span class="st">"IAH"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>speed <span class="op">=</span> <span class="va">distance</span> <span class="op">/</span> <span class="va">air_time</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">year</span><span class="op">:</span><span class="va">day</span>, <span class="va">dep_time</span>, <span class="va">carrier</span>, <span class="va">flight</span>, <span class="va">speed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">speed</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 7,198 × 7</span></span>
<span><span class="co">#&gt;    year month   day dep_time carrier flight speed</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt; &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  2013     7     9      707 UA         226  522.</span></span>
<span><span class="co">#&gt; 2  2013     8    27     1850 UA        1128  521.</span></span>
<span><span class="co">#&gt; 3  2013     8    28      902 UA        1711  519.</span></span>
<span><span class="co">#&gt; 4  2013     8    28     2122 UA        1022  519.</span></span>
<span><span class="co">#&gt; 5  2013     6    11     1628 UA        1178  515.</span></span>
<span><span class="co">#&gt; 6  2013     8    27     1017 UA         333  515.</span></span>
<span><span class="co">#&gt; # ℹ 7,192 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>이 파이프라인에는 4단계가 있지만 동사가 각 줄의 시작 부분에 오기 때문에 훑어보기 쉽습니다. <code>flights</code> 데이터로 시작한 다음 필터링하고, 변형하고, 선택하고, 정렬합니다.</p>
<p>파이프가 없었다면 어떻게 되었을까요? 각 함수 호출을 이전 호출 안에 중첩할 수 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>        <span class="va">flights</span>, </span>
<span>        <span class="va">dest</span> <span class="op">==</span> <span class="st">"IAH"</span></span>
<span>      <span class="op">)</span>,</span>
<span>      speed <span class="op">=</span> <span class="va">distance</span> <span class="op">/</span> <span class="va">air_time</span> <span class="op">*</span> <span class="fl">60</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">year</span><span class="op">:</span><span class="va">day</span>, <span class="va">dep_time</span>, <span class="va">carrier</span>, <span class="va">flight</span>, <span class="va">speed</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">speed</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>또는 중간 객체를 많이 사용할 수도 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">flights</span>, <span class="va">dest</span> <span class="op">==</span> <span class="st">"IAH"</span><span class="op">)</span></span>
<span><span class="va">flights2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">flights1</span>, speed <span class="op">=</span> <span class="va">distance</span> <span class="op">/</span> <span class="va">air_time</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span></span>
<span><span class="va">flights3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">flights2</span>, <span class="va">year</span><span class="op">:</span><span class="va">day</span>, <span class="va">dep_time</span>, <span class="va">carrier</span>, <span class="va">flight</span>, <span class="va">speed</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">flights3</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">speed</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>두 형식 모두 때와 장소가 있지만 파이프는 일반적으로 쓰기 쉽고 읽기 쉬운 데이터 분석 코드를 생성합니다.</p>
<p>코드에 파이프를 추가하려면 내장 키보드 단축키인 Ctrl/Cmd + Shift + M을 사용하는 것이 좋습니다. <a href="#fig-pipe-options" class="quarto-xref">Figure&nbsp;<span>3.1</span></a> 에 표시된 대로 <code>%&gt;%</code> 대신 <code>|&gt;</code>를 사용하려면 RStudio 옵션을 하나 변경해야 합니다. <code>%&gt;%</code>에 대해서는 잠시 후에 자세히 설명하겠습니다.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-pipe-options" class="quarto-float quarto-figure quarto-figure-center anchored" alt="&quot;Code&quot; 옵션의 &quot;Editing&quot; 패널에서 찾을 수 있는 &quot;Use native pipe operator&quot;  옵션을 보여주는 스크린샷.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pipe-options-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/rstudio-pipe-options.png" class="img-fluid figure-img" alt="&quot;Code&quot; 옵션의 &quot;Editing&quot; 패널에서 찾을 수 있는 &quot;Use native pipe operator&quot;  옵션을 보여주는 스크린샷." width="616">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pipe-options-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: <code>|&gt;</code>를 삽입하려면 “Use native pipe operator” 옵션이 선택되어 있는지 확인하세요.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>magrittr
</div>
</div>
<div class="callout-body-container callout-body">
<p>한동안 tidyverse를 사용해 왔다면 <strong>magrittr</strong> 패키지에서 제공하는 <code>%&gt;%</code> 파이프에 익숙할 수 있습니다. magrittr 패키지는 핵심 tidyverse에 포함되어 있으므로 tidyverse를 로드할 때마다 <code>%&gt;%</code>를 사용할 수 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>간단한 경우 <code>|&gt;</code>와 <code>%&gt;%</code>는 동일하게 작동합니다. 그렇다면 왜 기본(base) 파이프를 권장할까요? 첫째, 기본 R의 일부이므로 tidyverse를 사용하지 않을 때도 항상 사용할 수 있습니다. 둘째, <code>|&gt;</code>는 <code>%&gt;%</code>보다 훨씬 간단합니다. 2014년에 <code>%&gt;%</code>가 발명된 후 2021년 R 4.1.0에 <code>|&gt;</code>가 포함되기까지의 시간 동안 우리는 파이프에 대해 더 잘 이해하게 되었습니다. 이를 통해 기본 구현에서 자주 사용되지 않고 덜 중요한 기능을 버릴 수 있었습니다.</p>
</div>
</div>
</section><section id="그룹" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="그룹">
<span class="header-section-number">3.5</span> 그룹</h2>
<p>지금까지 행과 열을 다루는 함수에 대해 배웠습니다. dplyr은 그룹으로 작업하는 기능을 추가하면 훨씬 더 강력해집니다. 이 섹션에서는 가장 중요한 함수인 <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> 및 슬라이스 함수 제품군에 초점을 맞출 것입니다.</p>
<section id="group_by" class="level3" data-number="3.5.1"><h3 data-number="3.5.1" class="anchored" data-anchor-id="group_by">
<span class="header-section-number">3.5.1</span> <code>group_by()</code>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>를 사용하여 데이터셋을 분석에 의미 있는 그룹으로 나누세요:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span><span class="co">#&gt; # Groups:   month [12]</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>는 데이터를 변경하지 않지만, 출력을 자세히 살펴보면 출력이 월별로 “그룹화”되었음을 나타내는 것을 알 수 있습니다(<code>Groups: month [12]</code>). 즉, 후속 작업은 이제 “월별로” 작동합니다. <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>는 이 그룹화된 기능(클래스라고 함)을 데이터 프레임에 추가하여 데이터에 적용되는 후속 동사의 동작을 변경합니다.</p>
</section><section id="sec-summarize" class="level3" data-number="3.5.2"><h3 data-number="3.5.2" class="anchored" data-anchor-id="sec-summarize">
<span class="header-section-number">3.5.2</span> <code>summarize()</code>
</h3>
<p>가장 중요한 그룹화된 작업은 요약(summary)으로, 단일 요약 통계를 계산하는 데 사용되는 경우 데이터 프레임을 각 그룹에 대해 단일 행을 갖도록 축소합니다. dplyr에서 이 작업은 <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>에 의해 수행되며, 다음 예제는 월별 평균 출발 지연을 계산합니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    avg_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dep_delay</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 12 × 2</span></span>
<span><span class="co">#&gt;   month avg_delay</span></span>
<span><span class="co">#&gt;   &lt;int&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1        NA</span></span>
<span><span class="co">#&gt; 2     2        NA</span></span>
<span><span class="co">#&gt; 3     3        NA</span></span>
<span><span class="co">#&gt; 4     4        NA</span></span>
<span><span class="co">#&gt; 5     5        NA</span></span>
<span><span class="co">#&gt; 6     6        NA</span></span>
<span><span class="co">#&gt; # ℹ 6 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>어라! 무언가 잘못되었고, 모든 결과가 R의 결측값 기호인 <code>NA</code>(“N-A”라고 발음)입니다. 이것은 관측된 일부 항공편의 지연 열에 누락된 데이터가 있기 때문에 발생했으며, 해당 값을 포함하여 평균을 계산했을 때 <code>NA</code> 결과가 나왔습니다. <a href="missing-values.html" class="quarto-xref"><span>Chapter 18</span></a> 에서 결측값에 대해 자세히 다시 다루겠지만, 지금은 <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> 함수에 <code>na.rm</code> 인수를 <code>TRUE</code>로 설정하여 모든 결측값을 무시하도록 지시할 것입니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    avg_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dep_delay</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 12 × 2</span></span>
<span><span class="co">#&gt;   month avg_delay</span></span>
<span><span class="co">#&gt;   &lt;int&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1      10.0</span></span>
<span><span class="co">#&gt; 2     2      10.8</span></span>
<span><span class="co">#&gt; 3     3      13.2</span></span>
<span><span class="co">#&gt; 4     4      13.9</span></span>
<span><span class="co">#&gt; 5     5      13.0</span></span>
<span><span class="co">#&gt; 6     6      20.8</span></span>
<span><span class="co">#&gt; # ℹ 6 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>에 대한 단일 호출로 원하는 만큼의 요약을 생성할 수 있습니다. 다가오는 장에서 다양한 유용한 요약을 배우겠지만, 매우 유용한 요약 중 하나는 각 그룹의 행 수를 반환하는 <code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code>입니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    avg_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dep_delay</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 12 × 3</span></span>
<span><span class="co">#&gt;   month avg_delay     n</span></span>
<span><span class="co">#&gt;   &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1     1      10.0 27004</span></span>
<span><span class="co">#&gt; 2     2      10.8 24951</span></span>
<span><span class="co">#&gt; 3     3      13.2 28834</span></span>
<span><span class="co">#&gt; 4     4      13.9 28330</span></span>
<span><span class="co">#&gt; 5     5      13.0 28796</span></span>
<span><span class="co">#&gt; 6     6      20.8 28243</span></span>
<span><span class="co">#&gt; # ℹ 6 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>평균과 개수는 데이터 과학에서 놀랍도록 많은 것을 얻게 해줍니다!</p>
</section><section id="slice_-함수들" class="level3" data-number="3.5.3"><h3 data-number="3.5.3" class="anchored" data-anchor-id="slice_-함수들">
<span class="header-section-number">3.5.3</span> <code>slice_</code> 함수들</h3>
<p>각 그룹 내에서 특정 행을 추출할 수 있는 5가지 편리한 함수가 있습니다:</p>
<ul>
<li>
<code>df |&gt; slice_head(n = 1)</code>은 각 그룹에서 첫 번째 행을 가져옵니다.</li>
<li>
<code>df |&gt; slice_tail(n = 1)</code>은 각 그룹에서 마지막 행을 가져옵니다.</li>
<li>
<code>df |&gt; slice_min(x, n = 1)</code>은 <code>x</code> 열의 값이 가장 작은 행을 가져옵니다.</li>
<li>
<code>df |&gt; slice_max(x, n = 1)</code>은 <code>x</code> 열의 값이 가장 큰 행을 가져옵니다.</li>
<li>
<code>df |&gt; slice_sample(n = 1)</code>은 임의의 행 하나를 가져옵니다.</li>
</ul>
<p><code>n</code>을 변경하여 둘 이상의 행을 선택하거나 <code>n =</code> 대신 <code>prop = 0.1</code>을 사용하여 각 그룹에서 (예를 들어) 10%의 행을 선택할 수 있습니다. 예를 들어, 다음 코드는 각 목적지에 도착했을 때 가장 많이 지연된 항공편을 찾습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dest</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">arr_delay</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">dest</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 108 × 19</span></span>
<span><span class="co">#&gt; # Groups:   dest [105]</span></span>
<span><span class="co">#&gt;   dest   year month   day dep_time sched_dep_time dep_delay arr_time</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 ABQ    2013     7    22     2145           2007        98      132</span></span>
<span><span class="co">#&gt; 2 ACK    2013     7    23     1139            800       219     1250</span></span>
<span><span class="co">#&gt; 3 ALB    2013     1    25      123           2000       323      229</span></span>
<span><span class="co">#&gt; 4 ANC    2013     8    17     1740           1625        75     2042</span></span>
<span><span class="co">#&gt; 5 ATL    2013     7    22     2257            759       898      121</span></span>
<span><span class="co">#&gt; 6 AUS    2013     7    10     2056           1505       351     2347</span></span>
<span><span class="co">#&gt; # ℹ 102 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>목적지는 105개인데 여기서는 108개의 행을 얻습니다. 무슨 일일까요? <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min()</a></code>과 <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max()</a></code>는 동점 값을 유지하므로 <code>n = 1</code>은 가장 높은 값을 가진 모든 행을 제공하라는 의미입니다. 그룹당 정확히 하나의 행을 원하면 <code>with_ties = FALSE</code>를 설정할 수 있습니다.</p>
<p>이것은 <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>로 최대 지연을 계산하는 것과 유사하지만, 단일 요약 통계 대신 전체 해당 행(또는 동점이 있는 경우 행들)을 얻습니다.</p>
</section><section id="여러-변수로-그룹화하기" class="level3" data-number="3.5.4"><h3 data-number="3.5.4" class="anchored" data-anchor-id="여러-변수로-그룹화하기">
<span class="header-section-number">3.5.4</span> 여러 변수로 그룹화하기</h3>
<p>하나 이상의 변수를 사용하여 그룹을 만들 수 있습니다. 예를 들어 각 날짜에 대한 그룹을 만들 수 있습니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">daily</span> <span class="op">&lt;-</span> <span class="va">flights</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span><span class="op">)</span></span>
<span><span class="va">daily</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span><span class="co">#&gt; # Groups:   year, month, day [365]</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>둘 이상의 변수로 그룹화된 티블을 요약하면 각 요약이 마지막 그룹을 벗겨냅니다. 지나고 보니 이것은 이 기능을 작동시키는 좋은 방법이 아니었지만, 기존 코드를 깨지 않고 변경하기는 어렵습니다. 무슨 일이 일어나고 있는지 명확하게 하기 위해 dplyr은 이 동작을 변경하는 방법을 알려주는 메시지를 표시합니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">daily_flights</span> <span class="op">&lt;-</span> <span class="va">daily</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'year', 'month'. You can override using</span></span>
<span><span class="co">#&gt; the `.groups` argument.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>이 동작에 만족하면 메시지를 억제하기 위해 명시적으로 요청할 수 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">daily_flights</span> <span class="op">&lt;-</span> <span class="va">daily</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>    .groups <span class="op">=</span> <span class="st">"drop_last"</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>또는 다른 값을 설정하여 기본 동작을 변경하세요. 예: 모든 그룹화를 삭제하려면 <code>"drop"</code>, 동일한 그룹을 보존하려면 <code>"keep"</code>.</p>
</section><section id="그룹화-해제하기" class="level3" data-number="3.5.5"><h3 data-number="3.5.5" class="anchored" data-anchor-id="그룹화-해제하기">
<span class="header-section-number">3.5.5</span> 그룹화 해제하기</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>를 사용하지 않고 데이터 프레임에서 그룹화를 제거하고 싶을 수도 있습니다. <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup()</a></code>으로 이 작업을 수행할 수 있습니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">daily</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></span>
<span><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></span>
<span><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></span>
<span><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></span>
<span><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></span>
<span><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></span>
<span><span class="co">#&gt; # ℹ 336,770 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, …</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>이제 그룹화되지 않은 데이터 프레임을 요약할 때 어떤 일이 발생하는지 봅시다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">daily</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    avg_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dep_delay</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    flights <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span><span class="co">#&gt;   avg_delay flights</span></span>
<span><span class="co">#&gt;       &lt;dbl&gt;   &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1      12.6  336776</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>dplyr은 그룹화되지 않은 데이터 프레임의 모든 행을 하나의 그룹에 속하는 것으로 취급하기 때문에 단일 행을 반환합니다.</p>
</section><section id="by" class="level3" data-number="3.5.6"><h3 data-number="3.5.6" class="anchored" data-anchor-id="by">
<span class="header-section-number">3.5.6</span> <code>.by</code>
</h3>
<p>dplyr 1.1.0에는 작업별 그룹화를 위한 새로운 실험적 구문인 <code>.by</code> 인수가 포함되어 있습니다. <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>와 <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup()</a></code>이 사라지는 것은 아니지만 이제 <code>.by</code> 인수를 사용하여 단일 작업 내에서 그룹화할 수도 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dep_delay</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">month</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>또는 여러 변수로 그룹화하려면:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dep_delay</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">dest</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code>.by</code>는 모든 동사와 함께 작동하며 작업이 완료되었을 때 그룹화 메시지를 억제하기 위해 <code>.groups</code> 인수를 사용하거나 <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup()</a></code>을 사용할 필요가 없다는 장점이 있습니다.</p>
<p>우리가 책을 썼을 때 이 구문이 매우 새로운 것이었기 때문에 이 장에서는 이 구문에 집중하지 않았습니다. 우리는 이것이 많은 가능성을 가지고 있고 꽤 인기가 있을 것 같다고 생각하기 때문에 언급하고 싶었습니다. <a href="https://www.tidyverse.org/blog/2023/02/dplyr-1-1-0-per-operation-grouping/">dplyr 1.1.0 블로그 게시물</a>에서 자세한 내용을 확인할 수 있습니다.</p>
</section><section id="연습문제-2" class="level3" data-number="3.5.7"><h3 data-number="3.5.7" class="anchored" data-anchor-id="연습문제-2">
<span class="header-section-number">3.5.7</span> 연습문제</h3>
<ol type="1">
<li><p>평균 지연 시간이 가장 나쁜 항공사는 어디입니까? 도전 과제: 나쁜 공항 대 나쁜 항공사의 영향을 풀 수 있습니까? 왜 그렇습니까/그렇지 않습니까? (힌트: <code>flights |&gt; group_by(carrier, dest) |&gt; summarize(n())</code>을 생각해보세요)</p></li>
<li><p>각 목적지로 출발할 때 가장 많이 지연된 항공편을 찾으세요.</p></li>
<li><p>지연은 하루 동안 어떻게 변합니까? 플롯으로 답을 설명하세요.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min()</a></code>과 친구들에게 음수 <code>n</code>을 제공하면 어떻게 됩니까?</p></li>
<li><p>방금 배운 dplyr 동사 측면에서 <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code>가 수행하는 작업을 설명하세요. <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code>에 대한 <code>sort</code> 인수는 무엇을 합니까?</p></li>
<li>
<p>다음과 같은 작은 데이터 프레임이 있다고 가정해 봅시다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>,</span>
<span>  z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"K"</span>, <span class="st">"K"</span>, <span class="st">"L"</span>, <span class="st">"L"</span>, <span class="st">"K"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ol type="a">
<li>
<p>출력이 어떻게 보일지 생각나는 대로 적은 다음 맞았는지 확인하고 <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>가 무엇을 하는지 설명하세요.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
<li>
<p>출력이 어떻게 보일지 생각나는 대로 적은 다음 맞았는지 확인하고 <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code>가 무엇을 하는지 설명하세요. 또한 (a) 부분의 <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>와 어떻게 다른지 언급하세요.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
<li>
<p>출력이 어떻게 보일지 생각나는 대로 적은 다음 맞았는지 확인하고 파이프라인이 무엇을 하는지 설명하세요.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
<li>
<p>출력이 어떻게 보일지 생각나는 대로 적은 다음 맞았는지 확인하고 파이프라인이 무엇을 하는지 설명하세요. 그런 다음 메시지가 무엇을 말하는지 언급하세요.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">z</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
<li>
<p>출력이 어떻게 보일지 생각나는 대로 적은 다음 맞았는지 확인하고 파이프라인이 무엇을 하는지 설명하세요. 출력이 (d) 부분의 출력과 어떻게 다릅니까?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">z</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
<li>
<p>출력이 어떻게 보일지 생각나는 대로 적은 다음 맞았는지 확인하고 각 파이프라인이 무엇을 하는지 설명하세요. 두 파이프라인의 출력은 어떻게 다릅니까?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">z</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">z</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mean_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</li>
</ol>
</li>
</ol></section></section><section id="sec-sample-size" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="sec-sample-size">
<span class="header-section-number">3.6</span> 사례 연구: 집계 및 표본 크기</h2>
<p>집계를 수행할 때마다 항상 개수(<code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code>)를 포함하는 것이 좋습니다. 그렇게 하면 매우 적은 양의 데이터에 근거하여 결론을 내리지 않도록 할 수 있습니다. <strong>Lahman</strong> 패키지의 야구 데이터를 사용하여 이를 보여줄 것입니다. 구체적으로 선수가 안타를 친 횟수(<code>H</code>) 대 공을 인플레이(in play)하려고 시도한 횟수(<code>AB</code>)의 비율을 비교할 것입니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">batters</span> <span class="op">&lt;-</span> <span class="fu">Lahman</span><span class="fu">::</span><span class="va"><a href="http://cdalzell.github.io/Lahman/reference/Batting.html">Batting</a></span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">playerID</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    performance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">H</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">AB</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">AB</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">batters</span></span>
<span><span class="co">#&gt; # A tibble: 20,985 × 3</span></span>
<span><span class="co">#&gt;   playerID  performance     n</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;dbl&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 aardsda01      0          4</span></span>
<span><span class="co">#&gt; 2 aaronha01      0.305  12364</span></span>
<span><span class="co">#&gt; 3 aaronto01      0.229    944</span></span>
<span><span class="co">#&gt; 4 aasedo01       0          5</span></span>
<span><span class="co">#&gt; 5 abadan01       0.0952    21</span></span>
<span><span class="co">#&gt; 6 abadfe01       0.111      9</span></span>
<span><span class="co">#&gt; # ℹ 20,979 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>타자의 기량(타율 <code>performance</code>로 측정) 대 공을 칠 기회(타수 <code>n</code>으로 측정)를 플롯하면 두 가지 패턴이 나타납니다:</p>
<ol type="1">
<li><p>타석 수가 적은 선수들 사이에서 <code>performance</code>의 변동이 더 큽니다. 이 플롯의 모양은 매우 특징적입니다. 평균(또는 기타 요약 통계) 대 그룹 크기를 플롯할 때마다 표본 크기가 커짐에 따라 변동이 감소하는 것을 볼 수 있습니다<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p></li>
<li><p>기량(<code>performance</code>)과 공을 칠 기회(<code>n</code>) 사이에는 양의 상관관계가 있습니다. 팀은 최고의 타자에게 공을 칠 기회를 가장 많이 주고 싶어하기 때문입니다.</p></li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">batters</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">performance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="data-transform_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" alt="타격 성적 대 타격 기회의 산점도에 매끄러운 선이 겹쳐져 있습니다.  평균 성적은 n이 ~100일 때 0.2에서 n이 ~1000일 때 0.25로 급격히  증가합니다. 평균 성적은 훨씬 완만한 기울기로 선형적으로 계속 증가하여  n이 ~12,000일 때 0.3에 도달합니다." width="576"></p>
</figure>
</div>
</div>
</div>
<p>ggplot2와 dplyr을 결합하는 편리한 패턴을 주목하세요. 데이터셋 처리를 위한 <code>|&gt;</code>에서 플롯에 레이어를 추가하기 위한 <code>+</code>로 전환해야 한다는 점만 기억하면 됩니다.</p>
<p>이것은 순위 매기기에도 중요한 의미를 갖습니다. <code>desc(performance)</code>로 순진하게 정렬하면 타율이 가장 좋은 사람들은 분명히 공을 인플레이하려고 시도한 횟수가 매우 적고 우연히 안타를 친 사람들이며, 반드시 가장 숙련된 선수는 아닙니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">batters</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">performance</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 20,985 × 3</span></span>
<span><span class="co">#&gt;   playerID  performance     n</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;dbl&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 abramge01           1     1</span></span>
<span><span class="co">#&gt; 2 alberan01           1     1</span></span>
<span><span class="co">#&gt; 3 banisje01           1     1</span></span>
<span><span class="co">#&gt; 4 bartocl01           1     1</span></span>
<span><span class="co">#&gt; 5 bassdo01            1     1</span></span>
<span><span class="co">#&gt; 6 birasst01           1     2</span></span>
<span><span class="co">#&gt; # ℹ 20,979 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>이 문제에 대한 좋은 설명과 해결 방법은 <a href="http://varianceexplained.org/r/empirical_bayes_baseball/" class="uri">http://varianceexplained.org/r/empirical_bayes_baseball/</a> 및 <a href="https://www.evanmiller.org/how-not-to-sort-by-average-rating.html" class="uri">https://www.evanmiller.org/how-not-to-sort-by-average-rating.html</a>에서 찾을 수 있습니다.</p>
</section><section id="요약" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="요약">
<span class="header-section-number">3.7</span> 요약</h2>
<p>이 장에서는 dplyr이 데이터 프레임 작업을 위해 제공하는 도구에 대해 배웠습니다. 도구는 대략 세 가지 범주로 분류됩니다: 행을 조작하는 도구(<code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> 및 <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> 등), 열을 조작하는 도구(<code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> 및 <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> 등), 그룹을 조작하는 도구(<code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> 및 <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> 등). 이 장에서는 이러한 “전체 데이터 프레임” 도구에 중점을 두었지만 개별 변수로 무엇을 할 수 있는지에 대해서는 아직 많이 배우지 않았습니다. 각 장에서 특정 유형의 변수에 대한 도구를 제공하는 책의 변형(Transform) 파트에서 다시 다룰 것입니다.</p>
<p>다음 장에서는 워크플로우로 다시 돌아가 코드 스타일의 중요성과 코드를 잘 정리하여 자신과 다른 사람들이 읽고 이해하기 쉽게 만드는 방법에 대해 논의할 것입니다.</p>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>나중에 위치에 따라 행을 선택할 수 있는 <code>slice_*()</code> 제품군에 대해 배울 것입니다.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>RStudio에서 열이 많은 데이터셋을 보는 가장 쉬운 방법은 <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code>임을 기억하세요.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>영국식 영어를 선호하는 경우 <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>도 가능합니다.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>*쿨럭* 대수의 법칙 *쿨럭*.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/r4ds\.hadley\.nz\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./workflow-basics.html" class="pagination-link" aria-label="워크플로우: 기초">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">워크플로우: 기초</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./workflow-style.html" class="pagination-link" aria-label="워크플로우: 코드 스타일">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">워크플로우: 코드 스타일</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>R for Data Science (2e) was written by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/hadley/r4ds/edit/main/data-transform.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/hadley/r4ds/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>